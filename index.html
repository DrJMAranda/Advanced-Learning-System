<!DOCTYPE html>
<html lang="en">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>SEA-ALSâ„¢ Curriculum Matrix</title>
Â  Â  <style>
Â  Â  Â  Â  /* Finalized CSS for Low Visual Burden and Structural Clarity */
Â  Â  Â  Â  body { font-family: 'Arial', sans-serif; background-color: #F8F0E3; color: #333; margin-top: 0; }
Â  Â  Â  Â  .container { max-width: 1100px; margin: 5px auto 20px auto; }
Â  Â  Â  Â  h1 { text-align: center; color: #1e40af; font-size: 2em; margin-bottom: 0px !important; }
Â  Â  Â  Â  h2 { text-align: center; font-size: 1.1em; color: #3b82f6; margin-top: 5px !important; margin-bottom: 5px !important; }
Â  Â  Â  Â  .credits { text-align: center; font-size: 0.75em; color: #6b7280; margin-bottom: 2px !important; }
Â  Â  Â  Â  .table-container { overflow-x: auto; width: 100%; }
Â  Â  Â  Â  table { width: 100%; border-collapse: collapse; margin-top: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); background-color: white; }
Â  Â  Â  Â  /* Grid Contrast and Top Alignment */
Â  Â  Â  Â  th, td { border: 1px solid #6b7280; padding: 6px 4px; text-align: center; vertical-align: top; }
Â  Â  Â  Â  th { background-color: #3b82f6; color: white; font-weight: bold; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Final Differentiated State Definitions */
Â  Â  Â  Â  .module-cell { cursor: pointer; background-color: #FFFFFF; transition: background-color 0.3s; } /* Matte White: Presence of Clickable Content */
Â  Â  Â  Â  .module-cell.state-0 { background-color: #d1d5db; color: #6b7280; cursor: default; } /* Gray: Content Absent (Inert Module) */
Â  Â  Â  Â  .module-cell:hover:not(.state-0):not(.state-1) { background-color: #e0f2f1; }
Â  Â  Â  Â  .state-1 { background-color: #C1D5E0; color: #333; font-weight: bold; } /* Matte Bluish Gray: Confirmed Mastery (Luz Conservada) */
Â  Â  Â  Â  .locked { cursor: not-allowed; background-color: #ef4444 !important; color: white; animation: shake 0.5s; }
Â  Â  Â  Â  @keyframes shake { 0% { transform: translateX(0); } 25% { transform: translateX(-5px); } 50% { transform: translateX(5px); } 75% { transform: translateX(-5px); } 100% { transform: translateX(0); } }
Â  Â  Â  Â  .context-cell { background-color: #e0f2f1; font-style: italic; font-size: 0.9em; cursor: default; }
Â  Â  </style>
</head>
<body>
Â  Â  <div class="container">
Â  Â  Â  Â  <h1>SEA-ALSâ„¢</h1>
Â  Â  Â  Â  <h2>JosÃ© M. Aranda, PhDÂ© | Email: SEA01ALS@gmail.com</h2>
Â  Â  Â  Â  <div class="credits">Developed and Programmed by ARAGEM</div>
Â  Â  Â  Â Â 
        <div class="table-container">
Â  Â  Â  Â  <table id="performanceTable">
Â  Â  Â  Â  Â  Â  <thead>
Â  Â  Â  Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th rowspan="2">Arithmetic</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th colspan="6">Language</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th rowspan="2">Vocabulary</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th rowspan="2">Literature</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th rowspan="2">Exercises</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th rowspan="2">Songs</th>
Â  Â  Â  Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Spa</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Eng</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Por</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Tag</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Fre</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Dut</th>
Â  Â  Â  Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  Â  Â  </thead>
Â  Â  Â  Â  Â  Â  <tbody>
Â  Â  Â  Â  Â  Â  Â  Â  <tr data-row-id="1"><td>U1S1</td><td class="module-cell state-0" data-subj="Arit_Ref"></td><td class="module-cell state-0" data-subj="Eng"></td><td class="module-cell state-0" data-subj="Spa"></td><td class="module-cell state-0" data-subj="Por"></td><td class="module-cell state-0" data-subj="Tag"></td><td class="module-cell state-0" data-subj="Fre"></td><td class="module-cell state-0" data-subj="Gua"></td><td class="module-cell state-0" data-subj="Vocb" data-seq="1"></td><td class="module-cell state-0" data-subj="Lit">Justicia</td><td class="module-cell misc-cell state-0" data-subj="Ejer"></td><td class="module-cell misc-cell state-0" data-subj="Mus"></td></tr>
Â  Â  Â  Â  Â  Â  Â  Â  <tr data-row-id="2"><td>U1S2</td><td class="module-cell state-0" data-subj="Arit_Ref"></td><td class="module-cell state-0" data-subj="Eng"></td><td class="module-cell state-0" data-subj="Spa"></td><td class="module-cell state-0" data-subj="Por"></td><td class="module-cell state-0" data-subj="Tag"></td><td class="module-cell state-0" data-subj="Fre"></td><td class="module-cell state-0" data-subj="Gua"></td><td class="module-cell state-0" data-subj="Vocb" data-seq="2"></td><td class="module-cell state-0" data-subj="Lit">Constancia</td><td class="module-cell misc-cell state-0" data-subj="Ejer"></td><td class="module-cell misc-cell state-0" data-subj="Mus"></td></tr>
Â  Â  Â  Â  Â  Â  Â  Â  <tr data-row-id="3"><td>U1S3</td><td class="module-cell state-0" data-subj="Arit_Ref"></td><td class="module-cell state-0" data-subj="Eng"></td><td class="module-cell state-0" data-subj="Spa"></td><td class="module-cell state-0" data-subj="Por"></td><td class="module-cell state-0" data-subj="Tag"></td><td class="module-cell state-0" data-subj="Fre"></td><td class="module-cell state-0" data-subj="Gua"></td><td class="module-cell state-0" data-subj="Vocb" data-seq="3"></td><td class="module-cell state-0" data-subj="Lit">Responsabilidad</td><td class="module-cell misc-cell state-0" data-subj="Ejer"></td><td class="module-cell misc-cell state-0" data-subj="Mus"></td></tr>
Â  Â  Â  Â  Â  Â  Â  Â  <tr data-row-id="4"><td>U2</td><td class="module-cell state-0" data-subj="Arit_Ref"></td><td class="module-cell state-0" data-subj="Eng"></td><td class="module-cell state-0" data-subj="Spa"></td><td class="module-cell state-0" data-subj="Por"></td><td class="module-cell state-0" data-subj="Tag"></td><td class="module-cell state-0" data-subj="Fre"></td><td class="module-cell state-0" data-subj="Gua"></td><td class="module-cell state-0" data-subj="Vocb" data-seq="4"></td><td class="module-cell state-0" data-subj="Lit">Libertad</td><td class="module-cell misc-cell state-0" data-subj="Ejer"></td><td class="module-cell misc-cell state-0" data-subj="Mus"></td></tr>
Â  Â  Â  Â  Â  Â  Â  Â  <tr data-row-id="5"><td>U3</td><td class="module-cell state-0" data-subj="Arit_Ref"></td><td class="module-cell state-0" data-subj="Eng"></td><td class="module-cell state-0" data-subj="Spa"></td><td class="module-cell state-0" data-subj="Por"></td><td class="module-cell state-0" data-subj="Tag"></td><td class="module-cell state-0" data-subj="Fre"></td><td class="module-cell state-0" data-subj="Gua"></td><td class="module-cell state-0" data-subj="Vocb" data-seq="5"></td><td class="module-cell state-0" data-subj="Lit">Verdad</td><td class="module-cell misc-cell state-0" data-subj="Ejer"></td><td class="module-cell misc-cell state-0" data-subj="Mus"></td></tr>
Â  Â  Â  Â  Â  Â  Â  Â  <tr data-row-id="6"><td>U4</td><td class="module-cell state-0" data-subj="Arit_Ref"></td><td class="module-cell state-0" data-subj="Eng"></td><td class="module-cell state-0" data-subj="Spa"></td><td class="module-cell state-0" data-subj="Por"></td><td class="module-cell state-0" data-subj="Tag"></td><td class="module-cell state-0" data-subj="Fre"></td><td class="module-cell state-0" data-subj="Gua"></td><td class="module-cell state-0" data-subj="Vocb" data-seq="6"></td><td class="module-cell state-0" data-subj="Lit">Honestidad</td><td class="module-cell misc-cell state-0" data-subj="Ejer"></td><td class="module-cell misc-cell state-0" data-subj="Mus"></td></tr>
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  <tr data-row-id="7"><td>U5</td><td class="module-cell state-0" data-subj="Arit_Ref"></td><td class="module-cell state-0" data-subj="Eng"></td><td class="module-cell state-0" data-subj="Spa"></td><td class="module-cell state-0" data-subj="Por"></td><td class="module-cell state-0" data-subj="Tag"></td><td class="module-cell state-0" data-subj="Fre"></td><td class="module-cell state-0" data-subj="Gua"></td><td class="module-cell state-0" data-subj="Vocb" data-seq="7"></td><td class="module-cell state-0" data-subj="Lit">Resp. Personal</td><td class="module-cell misc-cell state-0" data-subj="Ejer"></td><td class="module-cell misc-cell state-0" data-subj="Mus"></td></tr>
Â  Â  Â  Â  Â  Â  Â  Â  <tr data-row-id="8"><td>U6</td><td class="module-cell state-0" data-subj="Arit_Ref"></td><td class="module-cell state-0" data-subj="Eng"></td><td class="module-cell state-0" data-subj="Spa"></td><td class="module-cell state-0" data-subj="Por"></td><td class="module-cell state-0" data-subj="Tag"></td><td class="module-cell state-0" data-subj="Fre"></td><td class="module-cell state-0" data-subj="Gua"></td><td class="module-cell state-0" data-subj="Vocb" data-seq="8"></td><td class="module-cell state-0" data-subj="Lit">Servicio Com.</td><td class="module-cell misc-cell state-0" data-subj="Ejer"></td><td class="module-cell misc-cell state-0" data-subj="Mus"></td></tr>
Â  Â  Â  Â  Â  Â  Â  Â  <tr data-row-id="9"><td>U7</td><td class="module-cell state-0" data-subj="Arit_Ref"></td><td class="module-cell state-0" data-subj="Eng"></td><td class="module-cell state-0" data-subj="Spa"></td><td class="module-cell state-0" data-subj="Por"></td><td class="module-cell state-0" data-subj="Tag"></td><td class="module-cell state-0" data-subj="Fre"></td><td class="module-cell state-0" data-subj="Gua"></td><td class="module-cell state-0" data-subj="Vocb" data-seq="9"></td><td class="module-cell state-0" data-subj="Lit">EmpatÃ­a</td><td class="module-cell misc-cell state-0" data-subj="Ejer"></td><td class="module-cell misc-cell state-0" data-subj="Mus"></td></tr>
Â  Â  Â  Â  Â  Â  Â  Â  <tr data-row-id="10"><td>U8</td><td class="module-cell state-0" data-subj="Arit_Ref"></td><td class="module-cell state-0" data-subj="Eng"></td><td class="module-cell state-0" data-subj="Spa"></td><td class="module-cell state-0" data-subj="Por"></td><td class="module-cell state-0" data-subj="Tag"></td><td class="module-cell state-0" data-subj="Fre"></td><td class="module-cell state-0" data-subj="Gua"></td><td class="module-cell state-0" data-subj="Vocb" data-seq="10"></td><td class="module-cell state-0" data-subj="Lit">CooperaciÃ³n</td><td class="module-cell misc-cell state-0" data-subj="Ejer"></td><td class="module-cell misc-cell state-0" data-subj="Mus"></td></tr>
Â  Â  Â  Â  Â  Â  Â  Â  <tr data-row-id="11"><td>U9</td><td class="module-cell state-0" data-subj="Arit_Ref"></td><td class="module-cell state-0" data-subj="Eng"></td><td class="module-cell state-0" data-subj="Spa"></td><td class="module-cell state-0" data-subj="Por"></td><td class="module-cell state-0" data-subj="Tag"></td><td class="module-cell state-0" data-subj="Fre"></td><td class="module-cell state-0" data-subj="Gua"></td><td class="module-cell state-0" data-subj="Vocb" data-seq="11"></td><td class="module-cell state-0" data-subj="Lit">Persistencia</td><td class="module-cell misc-cell state-0" data-subj="Ejer"></td><td class="module-cell misc-cell state-0" data-subj="Mus"></td></tr>
Â  Â  Â  Â  Â  Â  Â  Â  <tr data-row-id="12"><td>U10</td><td class="module-cell state-0" data-subj="Arit_Ref"></td><td class="module-cell state-0" data-subj="Eng"></td><td class="module-cell state-0" data-subj="Spa"></td><td class="module-cell state-0" data-subj="Por"></td><td class="module-cell state-0" data-subj="Tag"></td><td class="module-cell state-0" data-subj="Fre"></td><td class="module-cell state-0" data-subj="Gua"></td><td class="module-cell state-0" data-subj="Vocb" data-seq="12"></td><td class="module-cell state-0" data-subj="Lit">Autodisciplina</td><td class="module-cell misc-cell state-0" data-subj="Ejer"></td><td class="module-cell misc-cell state-0" data-subj="Mus"></td></tr>
Â  Â  Â  Â  Â  Â  Â  Â  <tr data-row-id="13"><td>U11</td><td class="module-cell state-0" data-subj="Arit_Ref"></td><td class="module-cell state-0" data-subj="Eng"></td><td class="module-cell state-0" data-subj="Spa"></td><td class="module-cell state-0" data-subj="Por"></td><td class="module-cell state-0" data-subj="Tag"></td><td class="module-cell state-0" data-subj="Fre"></td><td class="module-cell state-0" data-subj="Gua"></td><td class="module-cell state-0" data-subj="Vocb" data-seq="13"></td><td class="module-cell state-0" data-subj="Lit">Humildad</td><td class="module-cell misc-cell state-0" data-subj="Ejer"></td><td class="module-cell misc-cell state-0" data-subj="Mus"></td></tr>
Â  Â  Â  Â  Â  Â  Â  Â  <tr data-row-id="14"><td>U12</td><td class="module-cell state-0" data-subj="Arit_Ref"></td><td class="module-cell state-0" data-subj="Eng"></td><td class="module-cell state-0" data-subj="Spa"></td><td class="module-cell state-0" data-subj="Por"></td><td class="module-cell state-0" data-subj="Tag"></td><td class="module-cell state-0" data-subj="Fre"></td><td class="module-cell state-0" data-subj="Gua"></td><td class="module-cell state-0" data-subj="Vocb" data-seq="14"></td><td class="module-cell state-0" data-subj="Lit">Paciencia</td><td class="module-cell misc-cell state-0" data-subj="Ejer"></td><td class="module-cell misc-cell state-0" data-subj="Mus"></td></tr>
Â  Â  Â  Â  Â  Â  Â  Â  <tr data-row-id="15"><td>U13</td><td class="module-cell state-0" data-subj="Arit_Ref" data-is-final="true"></td><td class="module-cell state-0" data-subj="Eng" data-is-final="true"></td><td class="module-cell state-0" data-subj="Spa" data-is-final="true"></td><td class="module-cell state-0" data-subj="Por" data-is-final="true"></td><td class="module-cell state-0" data-subj="Tag" data-is-final="true"></td><td class="module-cell state-0" data-subj="Fre" data-is-final="true"></td><td class="module-cell state-0" data-subj="Gua" data-is-final="true"></td><td class="module-cell state-0" data-subj="Vocb" data-seq="15"></td><td class="module-cell state-0" data-subj="Lit" data-is-final="true">Conciencia</td><td class="module-cell misc-cell state-0" data-subj="Ejer"></td><td class="module-cell misc-cell state-0" data-subj="Mus"></td></tr>
Â  Â  Â  Â  Â  Â  </tbody>
Â  Â  Â  Â  </table>
        </div>
Â  Â  Â  Â  <div id="iconContainer" style="text-align: center; margin-top: 15px; font-size: 2em; color: #1e40af; min-height: 40px;"></div>
        <div id="statusMessage" style="text-align: center; margin-top: 10px; color: #3b82f6;">El Ã­ndice se ha poblado y estÃ¡ gobernando. Haga clic en una celda blanca para iniciar la rectificaciÃ³n.</div>
Â  Â  </div>

Â  Â  <script>
Â  Â  Â  Â  document.addEventListener('DOMContentLoaded', () => {
Â  Â  Â  Â  Â  Â  const table = document.getElementById('performanceTable');
Â  Â  Â  Â  Â  Â  const statusDiv = document.getElementById('statusMessage');
Â  Â  Â  Â  Â  Â  const iconContainer = document.getElementById('iconContainer');Â 
Â  Â  Â  Â  Â  Â Â 
            // FINAL INSTRUMENTAL CODE INSERTION (ACHIEVE TABULA RASA)
            for (let rowId = 1; rowId <= 6; rowId++) {
                const row = document.querySelector(`tr[data-row-id="${rowId}"]`);
                if (row) {
                    row.querySelectorAll('.module-cell.state-0').forEach(cell => {
                        const subjId = cell.dataset.subj;
                        // Exclude modules without immediate content (Por, Tag, Fre, Dut, Gua)
                        if (!['Por', 'Tag', 'Fre', 'Dut'].includes(subjId)) {
                            // This action flips the cell from Lighthouse Gray to Matte White
                            cell.classList.remove('state-0');
                        }
                    });
                }
            }
            // END FINAL INSTRUMENTAL CODE
            
Â  Â  Â  Â  Â  Â  function getEstado(id) {
Â  Â  Â  Â  Â  Â  Â  Â  const cell = document.getElementById(id);
Â  Â  Â  Â  Â  Â  Â  Â  if (!cell) return false;
Â  Â  Â  Â  Â  Â  Â  Â  return cell.classList.contains('state-1');
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  // --- 1. FUNCIÃ“N DE LANZAMIENTO (EXECUTES LAUNCH AND SETS PENDING FLAG) ---
            function launchModule(rowId, subjId, cell) {
                const BASE_URL_STORAGE = "https://storage.googleapis.com/noenbalde/";
                const BASE_FOLDERS = {
                    'Lit': 'Curriculum/Language/Literature/',
                    'Vocb': 'Curriculum/Language/Vocabulary/',
                    'Ejer': 'Curriculum/Wellness/Exercises/',
                    'Mus': 'Curriculum/Wellness/Music/',
                    'Eng': 'Curriculum/Mathematics/Arithmetic/',
                    'Spa': 'Curriculum/Mathematics/Arithmetic/',
                    'Por': 'Curriculum/Mathematics/Arithmetic/',
                    'Tag': 'Curriculum/Mathematics/Arithmetic/',
                    'Fre': 'Curriculum/Mathematics/Arithmetic/',
                    'Gua': 'Curriculum/Mathematics/Arithmetic/',
                    'Arit_Ref': 'Curriculum/Mathematics/Arithmetic/',
                };

                const folderPath = BASE_FOLDERS[subjId] || 'Curriculum/';
                let fileCode = '';
                let rowTitleCell = document.querySelector(`tr[data-row-id="${rowId}"] > td:first-child`);
                let rowTitle = rowTitleCell ? rowTitleCell.textContent : '';

                if (['Eng', 'Spa', 'Por', 'Tag', 'Fre', 'Gua'].includes(subjId)) {
                    // FIX: Ensure 'ESP' is used for Spanish, not the generic substring
                    let langCode = subjId.toUpperCase().substring(0, 3);
                    if (subjId === 'Spa') {
                        langCode = 'ESP'; // Corrected mapping for the actual file name
                    } else if (subjId === 'Eng') {
                        langCode = 'ENG';
                    }
                    fileCode = `AP1${rowTitle}${langCode}`; 

                } else if (subjId === 'Vocb') {
                    const seq = cell.dataset.seq;
                    fileCode = `LV${seq}`;
                } else if (subjId === 'Lit') {
                    fileCode = cell.textContent.split(' ')[0];
                } else if (subjId === 'Arit_Ref') {
                    fileCode = rowTitle;
                } else if (['Ejer', 'Mus'].includes(subjId)) {
                    const seq = document.querySelector(`tr[data-row-id="${rowId}"] [data-subj="Vocb"]`).dataset.seq;
                    fileCode = `${subjId.toUpperCase().substring(0, 4)}${seq}`; 
                }

                const filePath = `${BASE_URL_STORAGE}${folderPath}${fileCode}.mp4`;

                window.open(filePath, '_blank'); 

                // ASYNCHRONOUS STATE STEP 1: Set PENDING flag on the cell after launch.
                cell.setAttribute('data-pending-rectification', 'true');
                statusDiv.textContent = `ðŸš€ Lanzamiento Iniciado: HolÃ³n ${cell.id} evocado. Haga clic otra vez para confirmar la RectificaciÃ³n (AbsorciÃ³n).`;
            }

Â  Â  Â  Â  Â  Â  // --- 2. LÃ“GICA DEL GUARDIÃN DEL ORDEN (MANAGES ASYNCHRONOUS CONFIRMATION) ---
Â  Â  Â  Â  Â  Â  function toggleModuleState(cell) {
Â  Â  Â  Â  Â  Â  Â  Â  const rowId = parseInt(cell.parentElement.dataset.rowId);
Â  Â  Â  Â  Â  Â  Â  Â  const subjId = cell.dataset.subj;
Â  Â  Â  Â  Â  Â  Â  Â  const cellId = cell.id;

Â  Â  Â  Â  Â  Â  Â  Â  // 0. GRAY GUARDRAIL: LOCKED / CONTENT ABSENT (INOP)
Â  Â  Â  Â  Â  Â  Â  Â  if (cell.classList.contains('state-0')) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  statusDiv.textContent = `ðŸš« HolÃ³n ${cellId}: Contenido Ausente (Gris). No hay reacciÃ³n al clic.`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  // 1. MATTE BLUISH GRAY STATE: EoL CONFIRMATION (SECOND CLICK) OR RELAUNCH
                if (cell.getAttribute('data-pending-rectification') === 'true' || getEstado(cellId)) {
                    
                    if (cell.getAttribute('data-pending-rectification') === 'true') {
                        // EoL CONFIRMATION LOGIC (Second Click)
                        
                        // Prerequisite Check for EoL (Structural Precedence)
                        const previousRowId = rowId - 1;
                        const previousCellId = `A${previousRowId}_${subjId}`;
                        const requiredLitId = `A${rowId}_Lit`;
                        const requiredAritRefId = `A${rowId}_Arit_Ref`;
                        
                        // Enforce the Axiom of Structural Precedence even upon EoL confirmation for data cells (excluding Lit/Vocb)
                        if (rowId > 1 && !['Lit', 'Vocb', 'Arit_Ref'].includes(subjId) && (!getEstado(previousCellId) || !getEstado(requiredLitId) || !getEstado(requiredAritRefId))) {
                            cell.classList.add('locked');
                            statusDiv.textContent = `âŒ ERROR: ViolaciÃ³n de la Secuencia. RectificaciÃ³n de requisitos esencial aÃºn pendiente.`;
                            setTimeout(() => cell.classList.remove('locked'), 1500);
                            cell.removeAttribute('data-pending-rectification'); // Clear flag to re-initiate launch attempt
                            return;
                        }

                        // Execute End-of-Loop (EoL) Confirmation
                        cell.removeAttribute('data-pending-rectification');
                        cell.classList.add('state-1'); // <--- FLIP TO MATTE BLUISH GRAY
                        statusDiv.textContent = `âœ… Ã‰xito Final: HolÃ³n ${cellId} Rectificado (Confirmed Mastery).`;
                        iconContainer.innerHTML = 'âœ¨';
                        setTimeout(() => iconContainer.innerHTML = '', 500);
                        return;
                    }
                    
                    // RELAUNCH LOGIC (Cell is already state-1)
                    iconContainer.innerHTML = 'âœ¨';Â 
                    setTimeout(() => iconContainer.innerHTML = '', 500);Â 
                    launchModule(rowId, subjId, cell);
                    return;
                }


Â  Â  Â  Â  Â  Â  Â  Â  // 2. MATTE WHITE STATE: INITIAL LAUNCH (First Click)
                
Â  Â  Â  Â  Â  Â  Â  Â  // --- V E R I F I C A C I Ã“ N DE LINEALIDAD Y REQUISITOS ---
                const previousRowId = rowId - 1;
                const previousCellId = `A${previousRowId}_${subjId}`;
                const requiredLitId = `A${rowId}_Lit`;
                const requiredAritRefId = `A${rowId}_Arit_Ref`;
                
                // Enforce prerequisites for the first launch attempt on data cells
                if (rowId > 1 && !['Lit', 'Vocb', 'Arit_Ref'].includes(subjId) && (!getEstado(previousCellId) || !getEstado(requiredLitId) || !getEstado(requiredAritRefId))) {
                    cell.classList.add('locked');
                    statusDiv.textContent = `âŒ ERROR: ViolaciÃ³n de la Secuencia. RectificaciÃ³n de requisitos esencial aÃºn pendiente.`;
                    setTimeout(() => cell.classList.remove('locked'), 1500);
                    return;
                }
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  // 3. Pass Verification: Initiate Launch (Start-of-Loop)
Â  Â  Â  Â  Â  Â  Â  Â  launchModule(rowId, subjId, cell);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  // --- FIN DE LA LÃ“GICA DEL GUARDIÃN DEL ORDEN ---


Â  Â  Â  Â  Â  Â  // --- 3. INITIALIZATION AND POPULATION LOGIC (SETS INITIAL WHITE CELLS) ---
Â  Â  Â  Â  Â  Â  table.querySelectorAll('tbody tr').forEach(row => {
Â  Â  Â  Â  Â  Â  Â  Â  const rowId = parseInt(row.dataset.rowId);
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  row.querySelectorAll('.module-cell, .context-cell').forEach(cell => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const subjId = cell.dataset.subj;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const cellId = `A${rowId}_${subjId}`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  cell.id = cellId;Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (cell.classList.contains('module-cell') || cell.classList.contains('context-cell')) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  cell.addEventListener('click', () => toggleModuleState(cell));
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // CORRECCIÃ“N UX: Remove all numerical content
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (!cell.classList.contains('context-cell')) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  cell.textContent = '';Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  statusDiv.textContent = "El Ã­ndice se ha poblado y estÃ¡ gobernando. Haga clic en una celda blanca para iniciar la rectificaciÃ³n.";
Â  Â  Â  Â  });
Â  Â  </script>
</body>Â 
</html>
